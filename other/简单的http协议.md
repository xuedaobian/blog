---
title: 简单的http协议
date: 2020-05-19 18:49:07
tags: 
 - 前端
copyright: true
---


### http协议用于客户端和服务器端之间的通信
<!--more-->
实际情况下，两台计算机作为客户端和服务器端的角色可能会互换，但是仅从一条通信线路来看，服务器端和客户端角色是确定的，http协议能明确区分客户端和服务器端。

### http通过请求和响应的交换达成通信

http协议规定，请求从客户端发出，服务器端响应该请求并返回。
请求报文由 请求方法，请求URI，协议版本，可选的请求首部字段，和内容实体构成。
响应报文由 协议版本，状态码，原因短语，可选的响应首部字段，和响应实体构成。

### http是不保存状态的协议

http协议自身不对请求和响应之间的通信状态进行保存。这是为了更快的处理大量事务，确保协议的可伸缩性的设计。
在web的不断发展下，因无状态导致业务处理变得棘手的情况变多。为了达到期望的状态保持功能，引入cookie技术。

### 请求URI定位资源

http协议使用URI定位互联网上的资源。
当客户端请求访问资源而发送请求时，URI需要将作为请求报文的请求URI包含在内。

### http方法 （1.1版本）

- GET: 获取资源
- POST：传输实体主体
- PUT: 传输文件 

        由于1.1版本的PUT不带验证机制，任何人都可以上传文件，存在安全性问题，一般不采用。
        在配合web应用程序的验证机制，或架构设计采用REST标准的同类网站，安全性会提高多。
- HEAD: 获得报文首部

        确认URI的有效性和资源更新的时间日期
- DELETE: 与PUT相反作用，要求一样
- OPTIONS: 询问支持的方法
- TRACE: 追踪路径

        让web服务器端将之前的请求通信环回给客户端的方法。
        客户端可以通过该方法查询发送出去的请求时怎么被加工的。
        容易引发XST攻击。
- CONNECT: 要求用隧道协议连接代理

        该方法要求在于代理服务器通信时简历隧道，实现用隧道协议进行TCP通信。
        主要使用SSL和TLS协议把通信内容加密后经网络隧道传输。

### 持久连接节省通信量

- 早期
    无状态的默认情况是一次TCP连接仅为了一次http请求建立，这种情况下造成无谓的TCP连接建立和断开，增加通信量的开销。
- 持久连接
    - 持久连接的特点是，只要任意一段没有明确提出断开连接，则保持TCP连接状态。
    - 旨在建立1次TCP连接后进行多次http请求和响应的交互。
    - 好处在于减少TCP连接的重复建立和断开所造成的的额外开销，减轻了服务器端的负载；对客户端来说，传输时间减少了，web页面的绘制工作的时间提前了，对用户来说，页面显示的速度加快了。
- 管线化
    实现了持久连接使得管线化成为可能。
    - 持久连接是一个http结束才能发起下一个http请求
    - 管线化是可以不必等待前面的http请求完成即可发起下一个http请求

### 使用Cookie的状态管理
http无状态，没有上下文环境，那么要如何解决保证http无状态这个特性的同时又解决需要保持状态的业务问题呢？Cookie技术通过在请求和响应报文中写入Cookie信息来控制客户端的状态。
Cookie会根据从服务器端发送的响应报文内的Set-Cookie的首部字段，通知客户端保存Cookie，当下次客户端再向该服务器端发起请求时，客户端自动在请求报文中加入Cookie值。服务器端将受到的Cookie与数据库比对，获得之前的状态。